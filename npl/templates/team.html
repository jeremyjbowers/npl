{% extends "base.html" %}

{% block title %}{{ team.name }} - The NPL{% endblock %}

{% block extra_head %}
<style>
/* Dark theme for team header box */
.box {
    background-color: var(--npl-bg-secondary) !important;
    color: var(--npl-text-primary) !important;
    border: 1px solid var(--npl-border) !important;
}

.box .title {
    color: var(--npl-text-primary) !important;
}

.box .subtitle {
    color: var(--npl-text-secondary) !important;
}

/* Dark theme tags */
.tag.is-light {
    background-color: var(--npl-bg-tertiary) !important;
    color: var(--npl-text-primary) !important;
}

.tag.is-info {
    background-color: var(--npl-info) !important;
    color: var(--npl-bg-primary) !important;
}

/* Dark theme position count navigation */
.position-count {
    background-color: var(--npl-bg-secondary) !important;
    border: 1px solid var(--npl-border) !important;
}

.position-count .heading {
    color: var(--npl-text-secondary) !important;
}

.position-count .title {
    color: var(--npl-text-primary) !important;
}

.position-count .title a {
    color: var(--npl-text-primary) !important;
}

.position-count .title a:hover {
    color: var(--npl-primary) !important;
}

/* Dark theme section titles */
h1.title, h2.title, h3.title {
    color: var(--npl-text-primary) !important;
}

/* Dark theme buttons */
.button.is-light {
    background-color: var(--npl-bg-tertiary) !important;
    color: var(--npl-text-primary) !important;
    border-color: var(--npl-border) !important;
}

.button.is-light:hover {
    background-color: var(--npl-bg-primary) !important;
}

/* Dark theme tables - ensure they override base styles */
.table {
    background-color: var(--npl-bg-secondary) !important;
    border: 1px solid var(--npl-border) !important;
    color: var(--npl-text-primary) !important;
}

.table thead th {
    background-color: var(--npl-bg-tertiary) !important;
    color: var(--npl-text-primary) !important;
    border-bottom: 2px solid var(--npl-border) !important;
}

.table tbody td {
    background-color: var(--npl-bg-secondary) !important;
    color: var(--npl-text-primary) !important;
    border-bottom: 1px solid var(--npl-border) !important;
}

.table tbody tr:hover td {
    background-color: var(--npl-bg-tertiary) !important;
}

/* Preserve status indicator colors with dark theme backgrounds */
.table tbody tr.minors td { 
    background-color: var(--npl-status-minors) !important; 
    color: var(--npl-text-primary) !important;
}
.table tbody tr.il-60 td { 
    background-color: var(--npl-status-il-60) !important; 
    color: var(--npl-text-primary) !important;
}
.table tbody tr.il-15 td, 
.table tbody tr.il-10 td, 
.table tbody tr.il-7 td { 
    background-color: var(--npl-status-il-other) !important; 
    color: var(--npl-text-primary) !important;
}
.table tbody tr.auction-nonmlb td { 
    background-color: var(--npl-status-nonmlb) !important; 
    color: var(--npl-text-primary) !important;
}
.table tbody tr.owned td { 
    background-color: var(--npl-status-owned) !important; 
    color: var(--npl-text-primary) !important;
}
.table tbody tr.majors td {
    background-color: var(--npl-bg-secondary) !important;
    color: var(--npl-text-primary) !important;
    font-weight: bold !important;
}

/* Force text color for all table content */
.table tbody tr, .table tbody tr td, .table tbody tr a {
    color: var(--npl-text-primary) !important;
}

.table tbody tr a:hover {
    color: var(--npl-primary) !important;
}

/* Mobile responsiveness for team tables */
@media screen and (max-width: 768px) {
    .table-container {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
    }
    
    .table.team-table {
        min-width: 1000px;
        font-size: 0.75rem;
    }
    
    .table.team-table th,
    .table.team-table td {
        padding: 0.25rem 0.15rem;
        white-space: nowrap;
    }
    
    .table.team-table th {
        font-size: 0.65rem;
    }
    
    /* Hide some columns on mobile for better readability */
    .table.team-table .hidden-mobile {
        display: none;
    }
}

/* Position count mobile improvements */
@media screen and (max-width: 768px) {
    .position-count {
        padding: 1rem !important;
        flex-wrap: wrap;
    }
    
    .position-count .level-item {
        margin-bottom: 0.5rem;
        min-width: calc(25% - 0.5rem);
    }
    
    .position-count .title {
        font-size: 1.25rem;
    }
    
    .position-count .heading {
        font-size: 0.65rem;
    }
}

@media screen and (max-width: 480px) {
    .position-count .level-item {
        min-width: calc(50% - 0.5rem);
    }
    
    .position-count .title {
        font-size: 1rem;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="block">
    <div class="box">
        <h1 class="title is-3">{{ team.name }}</h1>
        <div class="subtitle">
            <span>
                <strong>Owner{% if team.owners.all|length > 1 %}s{% endif %}:</strong>
                {% for owner in team.owners.all %}
                    {% if not forloop.first %}, {% endif %}
                    <span class="tag is-light">{{ owner }}</span>
                {% endfor %}
            </span>
        </div>
        
        {% if team.league %}
        <div class="field is-grouped is-grouped-multiline">
            <div class="control">
                <span class="tag is-info">
                    <span>{{ team.league.name }}</span>
                </span>
            </div>
        </div>
        {% endif %}
    </div>
</div>

<div class="block">
    <nav class="level position-count p-4" style="border-radius: 8px;">
        <div class="level-item has-text-centered">
            <div>
                <p class="heading">Total</p>
                <p class="title">{{ total_count }}</p>
            </div>
        </div>
        <div class="level-item has-text-centered">
            <div>
                <p class="heading">40-man</p>
                <p class="title">{{ roster_40_man_count }}</p>
            </div>
        </div>
        {% regroup hitters by simple_position as position_players %}
        {% for position in position_players %}
        <div class="level-item has-text-centered">
            <div>
                <p class="heading">{{ position.grouper }}</p>
                <p class="title">
                    <a href="#position-{{ position.grouper }}">
                        {{ position.list|length }}
                    </a>
                </p>
            </div>
        </div>
        {% endfor %}
        <div class="level-item has-text-centered">
            <div>
                <p class="heading">P</p>
                <p class="title">
                    <a href="#position-p">{{ pitchers|length }}</a>
                </p>
            </div>
        </div>
    </nav>
</div>

<div class="block">
    <h2 class="title is-4" id="mlb-roster">
        MLB Roster
        <a href="#top" class="button is-small is-light ml-2">
            <span>top</span>
        </a>
    </h2>
    
    <div class="table-container">
        <table class="table is-fullwidth is-striped is-hoverable team-table">
            <thead>
                <tr>
                    <th>Pos</th>
                    <th>Player</th>
                    <th></th>
                    <th>Roster</th>
                    <th>Age</th>
                    <th>MLB</th>
                    <th>MLS</th>
                    <th>Opt</th>
                    <th>Status</th>
                    <th>2025</th>
                    <th>2026</th>
                    <th>2027</th>
                    <th>2028</th>
                    <th>2029</th>
                    <th>2030</th>
                    <th>2031</th>
                    <th>2032</th>
                </tr>
            </thead>
            <tbody>
                {% for p in mlb_pitchers %}{% include "includes/player_row.html" %}{% endfor %}
                {% regroup mlb_hitters by simple_position as position_players %}
                {% for position in position_players %}
                    {% for p in position.list %}{% include "includes/player_row.html" %}{% endfor %}
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<div class="block">
    <h2 class="title is-4" id="aaa-roster">
        AAA Roster
        <a href="#top" class="button is-small is-light ml-2">
            <span>top</span>
        </a>
    </h2>
    
    <div class="table-container">
        <table class="table is-fullwidth is-striped is-hoverable team-table">
            <thead>
                <tr>
                    <th>Pos</th>
                    <th>Player</th>
                    <th></th>
                    <th>Roster</th>
                    <th>Age</th>
                    <th>MLB</th>
                    <th>MLS</th>
                    <th>Opt</th>
                    <th>2025</th>
                    <th>2026</th>
                    <th>2027</th>
                    <th>2028</th>
                    <th>2029</th>
                    <th>2030</th>
                    <th>2031</th>
                    <th>2032</th>
                </tr>
            </thead>
            <tbody>
                {% for p in aaa_pitchers %}{% include "includes/player_row.html" %}{% endfor %}
                {% regroup aaa_hitters by simple_position as position_players %}
                {% for position in position_players %}
                    {% for p in position.list %}{% include "includes/player_row.html" %}{% endfor %}
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<div class="block">
    <h2 class="title is-4" id="aa-roster">
        AA Roster
        <a href="#top" class="button is-small is-light ml-2">
            <span>top</span>
        </a>
    </h2>
    
    <div class="table-container">
        <table class="table is-fullwidth is-striped is-hoverable team-table">
            <thead>
                <tr>
                    <th>Pos</th>
                    <th>Player</th>
                    <th></th>
                    <th>Roster</th>
                    <th>Age</th>
                    <th>MLB</th>
                    <th>MLS</th>
                    <th>Opt</th>
                    <th>Status</th>
                    <th>2025</th>
                    <th>2026</th>
                    <th>2027</th>
                    <th>2028</th>
                    <th>2029</th>
                    <th>2030</th>
                    <th>2031</th>
                    <th>2032</th>
                </tr>
            </thead>
            <tbody>
                {% for p in aa_pitchers %}{% include "includes/player_row.html" %}{% endfor %}
                {% for p in aa_hitters %}{% include "includes/player_row.html" %}{% endfor %}
            </tbody>
        </table>
    </div>
</div>

<div class="block">
    <h2 class="title is-4" id="a-roster">
        A Roster
        <a href="#top" class="button is-small is-light ml-2">
            <span>top</span>
        </a>
    </h2>
    
    <div class="table-container">
        <table class="table is-fullwidth is-striped is-hoverable team-table">
            <thead>
                <tr>
                    <th>Pos</th>
                    <th>Player</th>
                    <th></th>
                    <th>Roster</th>
                    <th>Age</th>
                    <th>MLB</th>
                    <th>MLS</th>
                    <th>Opt</th>
                    <th>Status</th>
                    <th>2025</th>
                    <th>2026</th>
                    <th>2027</th>
                    <th>2028</th>
                    <th>2029</th>
                    <th>2030</th>
                    <th>2031</th>
                    <th>2032</th>
                </tr>
            </thead>
            <tbody>
                {% for p in a_pitchers %}{% include "includes/player_row.html" %}{% endfor %}
                {% for p in a_hitters %}{% include "includes/player_row.html" %}{% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}